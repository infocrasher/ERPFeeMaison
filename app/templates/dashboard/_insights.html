<section class="section-card">
    <div class="insight-banner level-{{ data.insights.banner.level }}">
        <i class="bi bi-lightning-charge"></i>
        <div>
            <p>{{ data.insights.banner.message }}</p>
            <small>Mise à jour automatique grâce aux rapports IA</small>
        </div>
    </div>

    <div class="grid gap-4 lg:grid-cols-3 mt-4">
        {% for insight in data.insights.cards %}
        <div class="insight-card {{ insight.severity }}">
            <div class="insight-icon">
                <i class="bi {{ insight.icon }}"></i>
            </div>
            <h5>{{ insight.title }}</h5>
            <p>{{ insight.message }}</p>
        </div>
        {% endfor %}
    </div>

    {% if data.insights.ai and data.insights.ai.available %}
    <div class="mt-6 pt-6 border-t border-gray-200">
        <h4 class="text-lg font-semibold mb-4 flex items-center gap-2">
            <i class="bi bi-robot"></i>
            Analyses IA
        </h4>
        
        <div class="grid gap-4 lg:grid-cols-2">
            {% if data.insights.ai.sales %}
            <div class="ai-insight-card bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4">
                <div class="flex items-center gap-2 mb-2">
                    <i class="bi bi-graph-up text-blue-600"></i>
                    <h5 class="font-semibold text-blue-900">Analyse Ventes</h5>
                    <span class="ml-auto text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">
                        {{ data.insights.ai.sales.provider|upper }}
                    </span>
                </div>
                <p class="text-sm text-gray-700 leading-relaxed">
                    {{ data.insights.ai.sales.analysis[:300] }}{% if data.insights.ai.sales.analysis|length > 300 %}...{% endif %}
                </p>
            </div>
            {% endif %}
            
            {% if data.insights.ai.stock %}
            <div class="ai-insight-card bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-4">
                <div class="flex items-center gap-2 mb-2">
                    <i class="bi bi-box-seam text-orange-600"></i>
                    <h5 class="font-semibold text-orange-900">Analyse Stock</h5>
                    <span class="ml-auto text-xs px-2 py-1 bg-orange-100 text-orange-700 rounded">
                        {{ data.insights.ai.stock.provider|upper }}
                    </span>
                </div>
                <p class="text-sm text-gray-700 leading-relaxed">
                    {{ data.insights.ai.stock.analysis[:300] }}{% if data.insights.ai.stock.analysis|length > 300 %}...{% endif %}
                </p>
            </div>
            {% endif %}
        </div>
        
        {% if data.insights.ai.forecast %}
        <div class="mt-4 bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
                <i class="bi bi-graph-up-arrow text-green-600"></i>
                <h5 class="font-semibold text-green-900">Prévisions Prophet (7 jours)</h5>
                <span class="ml-auto text-xs px-2 py-1 bg-green-100 text-green-700 rounded">
                    PROPHET
                </span>
            </div>
            <p class="text-sm text-gray-700">
                Les prévisions sont disponibles. Consultez les graphiques pour voir les tendances.
            </p>
        </div>
        {% endif %}
    </div>
    {% endif %}
</section>

